import random
import os
import string
import aeslib


with open("/Users/stefaniancu/Downloads/vuln.c", "rb") as f:
    chunk = f.read(1024)

#print(chunk)

plaintext = b'ea27fd4bab813868c59cdd9cac391de5277ecc7da5c40f6410df8551e06e1f6ccbfd07126607caf27ca7062bbdd620622416cc94989ec8d5bf15e559a3a5f83e16f9853a8a8568a3688e9462fb80133e24e6a559b861ff8ef8c48be9a5f73a5d71b3feae9e3c080f13cbd8e56202c6853290b1fdf34cb9066f9c4c4e4bb24460e3448595278d5766fc71067ec03da59a28a20e1214ea8bd3d0c13e3cc0cd0289e59e015d3e0218d471504a5cc133247c724c85634488b1a7a42ed2380861cb6a6492d058557a9e8e00a2257d04d27b8d5589dafb9e1b511df028a21d7fef253e73398be67fbcf16c93c5025f46e7fd6ca3780b16d55b1bb0026c24dce063658a886d411fa86ee039e57bac1ff607d8fb59156e4bc7d6be75e10e47b442a2d0c74e6b4acce7ff0e78f321529c4740a7434f508fb4d6756a287c30482abf2804960b146376c9f39e250f636998008cec10a855f9b635515c5d61d9383392e06f409289eb3e85154bba954ace4590b13da15ffc7a91e4b4e93e1aec0a485f19104ab11b2c99867c3aa47b0b9bf1ab07dd936b06a7d7802408a103be887db6e65fb85c53c748d385f1c28ca6a98e08c7f3dadc43a16c8b53b799c41a371c90fa757ddea4af486093fa91ec2a92b7423a13c6f6ed6d1474ccf343a213c6fb789dc0977f030b7e8b26d3b66065be4145947109bd0a9b8696551a2f8ec235635ff9a16d3d1fe35e33daf18e3c47fba1feca4712966717bf3dab721e7cb5f853027db73e8ebc0fd538e5dcef76382c8c08ecaf8b93a0a5a5177d7ef79df60337962cecb010a591e261600e7306795ecb54df26db15cd2abae9fe5df49643e70bc8f9392072b46931ccc585d69ed124182abfab6ea342582dab86f9a84e7c8edf24d88a6e50b26d6e01e6247f827985cc129dfad901603ad0d8d639ebbecaab42d24b860ad196bf742ee36389c5048abe8940b98caa0085d1971bd0f6bbb2cf000464cefa9acfc4ceb01d8029221cf3db1ac583347dbc0d85c81fbd1f5b66aded32b764a91ab63023a25f71dd4e72384da5d2c7e0d20dde7f4cf086be3344cb00d98b84ebeb7821cc16cecf4cf0f65bddb6331624701e9e03298c9f1ebe03da6a48576fca8369a0502a061747fd63846aa305d63331d58fef8f97d40086162759b7afa4a05c82ae2c1486c542d1b4936850306d34b3a069dfb5a4dbcad6318a2c66db121e8ea17a25e90a5beb572e9ab664f7e78dff8b79ef9d04eccf7792f5822f6b24e55ecae6403c6567a119e2c2af760852ea39cbd4521d35f49ffa4f8acc04e2ba74a6437ef0b358adb303d6dca0965869dc92cece486dd5c70caebd019434fc8a3f5471e5841cb5806de194a6a3edbb21972a5f7949ca44f5b80ee252a60a1fe93e9eae88c2550a69430a6c4ea3b15c078232090bc804662e57ce13aafbe7a33e9918d504e35a387e47b3ce5027fa87fa5968555c9f55a8294529d4ebdfa5c0285e1034b0fce66bc3d827e7d055297fcf857e3e39cebd6351f858feaa6cb2a3e261e432da813060f29fea7869b2e789b88c7834f91de1548f21951af8b7c6664aa96fb703eb7e88af954f4467c294f082b4ea8328e14ca1182ae06c0ef1ae8789dd2aaa02d0826e55c7d2ab20854cf46f3d5bf7cf229be102532f9fe9e6e3b9446fcccaab45883d75d2828b972edacd4f20c6a78ef7b0b62c06df30c9cd6f9b5511111d191d764e08bc72a1e626bbdfc498e537f9d21a1e5c7a82edbe451acdd6806cf95e84ee52f1f140774185b7fe8618f709ca37def6f6548570c253e0322566e42538dcd2263816a921bd07f4f44df0d1ae1a2bb403ff0ac22ed5379fc5aa4d1c8fa0f4e60e43d3b41b2ce122bd7c8efaf28d7bb145dfbe76d80dd4939b9484b0935f51e44c9b54257876d3d3018fa05b164dc85522d9f16fff62a7e35551f8f46a56b6771080482614e5907df5af9b8cfb5acd2b62c9000b13cc06440f3fcf'
key = """Tz
                   9~tfzfuzp=8+%Tio&X3+^~6}MP
                   
"""
iv = "e9ea68f94bc7b4d098c6b8c5080394df"

decrypted = bytes.fromhex(bytes.fromhex(aeslib.aes_decrypt(plaintext.decode(), key.encode().hex(), iv)).decode('ascii')).decode('ascii')

print(decrypted)

#cipher = aeslib.aes_encrypt(plaintext, key, iv).encode()
#print(cipher)

#decrypted = bytes.fromhex(aeslib.aes_decrypt(cipher.decode(), key, iv)).decode('ascii')
#print(decrypted)
#print(plaintext)

#print(cipher)
#print(bytes.fromhex(decrypted).decode('ascii'))